<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AstroLab</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
html {
  font-size: clamp(14px, 1.05vw, 16px);
}

/* üî• AUTO SCALE EVERYTHING */
@media (max-width: 1200px) {
}
@media (max-width: 992px) {
}
@media (max-width: 768px) {
}
@media (max-width: 480px) {
}
@media (max-width: 768px) {
  .extra-pages {
    display: none;
  }
}
:root {
  --bg-main: #f8fafc;
  --bg-soft: #ffffff;
  --bg-glass: rgba(255,255,255,.75);

  --primary: #6366f1;
  --primary-dark: #4f46e5;
  --primary-glow: rgba(99,102,241,.35);

  --accent: #22c55e;
  --danger: #ef4444;
  --warning: #f59e0b;

  --text-main: #0f172a;
  --text-soft: #475569;
  --text-muted: #94a3b8;

  --border: rgba(15,23,42,.08);

  --radius-sm: 12px;
  --radius-md: 16px;
  --radius-lg: 22px;

  --shadow-xs: 0 4px 10px rgba(15,23,42,.06);
  --shadow-sm: 0 12px 24px rgba(15,23,42,.08);
  --shadow-md: 0 20px 40px rgba(15,23,42,.12);
  --shadow-xl: 0 40px 80px rgba(15,23,42,.18);
}

* {
  -webkit-tap-highlight-color: transparent;
  box-sizing: border-box;
  transition:
    background-color .25s ease,
    color .25s ease,
    box-shadow .3s cubic-bezier(.4,0,.2,1),
    transform .3s cubic-bezier(.4,0,.2,1),
    opacity .3s ease;
}


body {
  margin: 0;
  font-family: Inter, system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  scroll-behavior: smooth;
  background:
    radial-gradient(1200px 600px at 10% -10%, #e0e7ff, transparent),
    radial-gradient(800px 400px at 90% 10%, #dcfce7, transparent),
    var(--bg-main);
  min-height: 100vh;
  display: flex;
  color: var(--text-main);
}
  body::before {
  content: "";
  position: fixed;
  inset: 0;
  background:
    radial-gradient(600px 300px at 50% 0%, rgba(99,102,241,.08), transparent),
    radial-gradient(400px 200px at 80% 20%, rgba(34,197,94,.06), transparent);
  pointer-events: none;
  z-index: 0;
}

/* ---------- SIDEBAR ---------- */
.sidebar {
    position: relative;
  z-index: 2;
  width: 260px;
  background: linear-gradient(180deg, #ffffff, #f8fafc);
  border-right: 1px solid var(--border);
  padding: 22px;
  display: flex;
  flex-direction: column;
  gap: 14px;
  box-shadow: var(--shadow-md);
  position: sticky;
  top: 0;
}

.sidebar h2 {
  margin: 0 0 10px;
}

.sidebar button {
  padding: 14px 16px;
  border-radius: var(--radius-md);
  border: 1px solid transparent;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  font-weight: 600;
  text-align: left;
  display: flex;
  align-items: center;
  gap: 10px;
  box-shadow: var(--shadow-sm);
}
  
.sidebar button:hover {
  box-shadow:
    0 0 0 1px rgba(255,255,255,.3),
    0 18px 40px rgba(99,102,241,.35);
}
.sidebar button:active {
  transform: scale(.97);
}

/* ---------- SETTINGS PANEL ---------- */
.settings {
  pointer-events: none;
  box-shadow: -30px 0 80px rgba(15,23,42,.25);
  position: fixed;
  backdrop-filter: blur(16px);
  right: -320px;
  top: 0;
  width: 320px;
  height: 100%;
  background: var(--bg-soft);
  border-left: 1px solid var(--border);
  padding: 18px;
  z-index: 1000;
  transition: right .35s cubic-bezier(.4,0,.2,1), opacity .3s;
  overflow-y: auto;
  opacity: 0;
}

.settings.open {
  pointer-events: auto;
  right: 0;
  opacity: 1;
}
  
.settings.open {
    pointer-events: auto;
  animation: panelIn .4s cubic-bezier(.4,0,.2,1);
}

@keyframes panelIn {
  from {
    transform: translateX(30px);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

/* ---------- MAIN ---------- */
.main {
    position: relative;
  z-index: 2;
  flex: 1;
  padding: 24px;
  overflow-y: auto;
  animation: fadeIn .4s ease;
}
.main > * {
  animation: floatUp .6s ease both;
}

.main > *:nth-child(1){ animation-delay:.05s }
.main > *:nth-child(2){ animation-delay:.1s }
.main > *:nth-child(3){ animation-delay:.15s }
.main > *:nth-child(4){ animation-delay:.2s }
@keyframes floatUp {
  from {
    opacity: 0;
    transform: translateY(18px) scale(.98);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}
/* ---------- CARDS ---------- */
.card {
  position: relative; /* ‚úÖ REQUIRED */
  background: var(--bg-glass);
  backdrop-filter: blur(12px);
  border-radius: var(--radius-lg);
  padding: 24px;
  overflow: hidden;
  margin-bottom: 20px;
  border: 1px solid var(--border);
  box-shadow: var(--shadow-sm);
  animation: cardIn .4s ease both;
}

.card:hover {
  box-shadow: var(--shadow-xl);
}
.card::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: linear-gradient(
    120deg,
    transparent,
    rgba(255,255,255,.4),
    transparent
  );
  opacity: 0;
  transition: opacity .4s;
  pointer-events: none; /* ‚úÖ THIS FIXES CLICK ISSUE */
}
.card::before {
  pointer-events: none;
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--primary), var(--accent));
  opacity: .85;
}
.card:hover::after {
  opacity: 1;
}
/* ---------- AVATAR ---------- */
.avatar {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  object-fit: cover;
  margin-bottom: 10px;
  box-shadow: 0 6px 18px rgba(0,0,0,.15);
}
.avatar:hover {
  transform: scale(1.05);
  box-shadow: 0 14px 32px rgba(0,0,0,.18);
}

/* ---------- INPUTS ---------- */
input, textarea {
  width: 100%;
  padding: 14px 16px;
  margin-top: 8px;
  border-radius: var(--radius-md);
  border: 1px solid var(--border);
  background: #ffffff;
  font-size: 14px;
  color: var(--text-main);
}

input:focus, textarea:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 4px var(--primary-glow);
}

button {
  padding: 14px 18px;
  border-radius: var(--radius-md);
  border: none;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  font-weight: 700;
  cursor: pointer;
  box-shadow: var(--shadow-sm);
}
  button {
  position: relative;
  z-index: 1;
  pointer-events: auto;
}
button:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-xl);
}
  
button:active {
  transform: scale(.94);
  box-shadow: 0 6px 14px rgba(0,0,0,.15) inset;
}

button:disabled {
  opacity: .5;
  cursor: not-allowed;
}

input:focus, textarea:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(79,70,229,.15);
}
.card button {
  margin-top: 10px;
}

button i {
  margin-right: 6px;
}
/* ---------- CHAT ---------- */
.chat-box {
  height: 320px;
  border: 1px solid var(--border);
  background: #ffffff;
  padding: 14px;
  border-radius: 16px;
  box-shadow: inset 0 1px 2px rgba(15,23,42,.04);
}

.message {
  position: relative;
  padding: 14px 18px;
  border-radius: 20px;
  background: #f1f5f9;
  max-width: 72%;
  box-shadow: var(--shadow-xs);
  animation: msgPop .35s cubic-bezier(.34,1.56,.64,1);
}
  
@keyframes msgPop {
  from {
    opacity: 0;
    transform: translateY(10px) scale(.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}


.message.self {
  box-shadow:
  0 6px 20px rgba(99,102,241,.35);
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  margin-left: auto;
}

.stars i{
  font-size:18px;
  color:#d1d5db;
  cursor:pointer;
  margin-right:4px;
}
.stars i.active{ color:#facc15; }

.review-box{
  margin-top:10px;
}
.review{
  font-size:13px;
  border-top:1px solid var(--border);
  padding-top:6px;
  margin-top:6px;
}
  /* ---------- REVIEW SIDE PANEL ---------- */
.review-panel {
  position: relative;
  margin-top: 12px;
  border: 1px solid var(--border);
  border-radius: 14px;
  background: #f9fafb;
  padding: 10px;
}

.review-stats {
  font-size: 12px;
  color: var(--muted);
  margin-bottom: 6px;
}

.review-stats div {
  display: flex;
  justify-content: space-between;
}

.review-scroll {
  max-height: 220px;
  overflow-y: auto;
  padding-right: 4px;
}

.review-item {
  border-top: 1px solid var(--border);
  padding: 6px 0;
  font-size: 13px;
}

.review-user {
  font-weight: 600;
  font-size: 12px;
}

.review-stars {
  color: #facc15;
  font-size: 13px;
}

.review-delete {
  background: #dc2626;
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 4px 6px;
  font-size: 11px;
  cursor: pointer;
  margin-top: 4px;
}
.online-toggle {
  display: flex;
  align-items: center;
  gap: 12px;
}

.online-toggle input {
  display: none;
}

.slider {
  width: 44px;
  height: 24px;
  background: #cbd5f5;
  border-radius: 999px;
  position: relative;
  cursor: pointer;
}

.slider::after {
  content: "";
  width: 18px;
  height: 18px;
  background: white;
  border-radius: 50%;
  position: absolute;
  top: 3px;
  left: 3px;
  transition: .25s;
  box-shadow: var(--shadow-xs);
}

.online-toggle input:checked + .slider {
  background: linear-gradient(135deg, #22c55e, #16a34a);
}

.online-toggle input:checked + .slider::after {
  transform: translateX(20px);
}
/* ---------- UTIL ---------- */
.hidden { display: none; }
#error { color: #dc2626; font-weight: 500; }

/* ---------- ANIMATIONS ---------- */
@keyframes fadeIn {
  from { opacity: 0 }
  to { opacity: 1 }
}

@keyframes slideInLeft {
  from { transform: translateX(-20px); opacity: 0 }
  to { transform: translateX(0); opacity: 1 }
}

@keyframes cardIn {
  from { transform: translateY(12px); opacity: 0 }
  to { transform: translateY(0); opacity: 1 }
}

@keyframes msgIn {
  from { transform: translateY(6px); opacity: 0 }
  to { transform: translateY(0); opacity: 1 }
}
@media (max-width: 768px) {

  body {
    flex-direction: column;
  }

  /* Bottom Navigation Bar */
  .sidebar {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 65px;
    display: flex;
    flex-direction: row;
    justify-content: space-around;
    align-items: center;
    padding: 5px 0;
    background: #ffffff;
    border-top: 1px solid var(--border);
    z-index: 1000;
  }

  /* Hide title + extra pages */
  .sidebar h2,
  .extra-pages {
    display: none !important;
  }

  /* Navigation buttons */
  .sidebar button {
    flex: 1;
    background: none;
    border: none;
    box-shadow: none;
    padding: 4px 0;
    font-size: 11px;
    color: var(--text-main);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2px;
  }

  .sidebar button i {
    font-size: 18px;
    margin: 0;
  }

  .sidebar button:hover {
    transform: none;
    box-shadow: none;
  }

  /* Push main content above bottom nav */
  .main {
    padding-bottom: 85px;
  }
}
</style>
</head>
<body>

<div id="settingsPanel" class="settings">
  <h3>Account Settings</h3>
  <img id="avatarPreview" class="avatar" src="" alt="Avatar">
  <input type="file" id="avatarInput" accept="image/*">
  <input id="s_name" placeholder="Display Name">
  <input id="s_speciality" placeholder="Speciality">
  <input id="s_experience" placeholder="Experience (years)">
<button type="button" onclick="saveSettings()">Save</button>
</div>

<div class="sidebar">
  <h2>AstroLab</h2>
  <div id="secretReset" style="height:20px; opacity:0;" onclick="secretTap()"></div>
  <button type="button" onclick="switchRole('client')">
  <i class="fa-solid fa-user"></i> Client
</button>
  <button type="button" id="astroBtn" onclick="switchRole('astrologer')">
  <i class="fa-solid fa-star"></i> Astrologer
</button>
  <button type="button" onclick="toggleSettings()">
  <i class="fa-solid fa-gear"></i> Settings
</button>
<button type="button" onclick="logout()">
  <i class="fa-solid fa-right-from-bracket"></i> Logout
</button>
<div class="extra-pages">
  <hr style="margin:14px 0; opacity:.2;">

  <button type="button" onclick="location.href='about.html'">
    <i class="fa-solid fa-circle-info"></i> About
  </button>

  <button type="button" onclick="location.href='privacy.html'">
    <i class="fa-solid fa-shield-halved"></i> Privacy
  </button>

  <button type="button" onclick="location.href='terms.html'">
    <i class="fa-solid fa-file-contract"></i> Terms
  </button>

  <button type="button" onclick="location.href='contact.html'">
    <i class="fa-solid fa-envelope"></i> Contact
  </button>
</div>
</div>

<div class="main">

    <!-- CLIENT VIEW -->
  <div id="clientView" class="hidden">
    <h3>Online Astrologers</h3>
    <div id="astrologerList"></div>
  </div>

  <p><strong>Your Credits:</strong> <span id="creditBalance">0</span></p>

  <div class="card">
    <h3>Buy Credits</h3>
    <button type="button" onclick="buyCredits(49)">üí† ‚Çπ49 ‚Äî Get 50 Credits</button>
    <button type="button" onclick="buyCredits(99)">‚≠ê ‚Çπ99 ‚Äî Get 100 Credits</button>
    <button type="button" onclick="buyCredits(249)">üî• ‚Çπ249 ‚Äî Get 250 Credits</button>
    <small style="color:#64748b;">Credits will be added within 24 hours after payment.</small>
  </div>

  <hr>
  <!-- ASTROLOGER VIEW -->
<div id="astrologerView" class="hidden">
  <p>Your Rate: <strong><span id="rateDisplay">0</span></strong> credits/min</p>

  <!-- üî• EDIT RATE -->
  <input id="rateInput" type="number" min="1" placeholder="Set credits per minute">
  <button type="button" onclick="updateRate()">Update Rate</button>

  <h3>Astrologer Dashboard</h3>
<p>
  <strong>Today's Earnings:</strong>
  <span id="todayEarnings">0</span> credits
</p>
  
<label style="display:flex;align-items:center;gap:10px;cursor:pointer;">
  <input
    type="checkbox"
    id="onlineToggle"
    onchange="onOnlineToggleChange(this)"
    style="width:18px;height:18px;"
  >
  <span id="onlineStatusText">Offline</span>
</label>

<h4>Chat Queue</h4>
<div id="queueList"></div>
  </div>

  <!-- CHAT VIEW -->
  <div id="chatView" class="hidden">
<h3 style="display:flex;justify-content:space-between;align-items:center;">
  Live Chat
  <span id="chatTimer" style="font-size:12px;color:#6b7280;">00:00</span>
</h3>
  <div class="chat-box" id="messages"></div>
    <div id="typingIndicator" style="font-size:12px;color:#6b7280;margin:6px 2px;min-height:16px;"></div>
    <input id="msgInput" placeholder="Type message..." />
    <br>
    <button type="button" onclick="sendMessage()">
  <i class="fa-solid fa-paper-plane"></i> Send
</button>
    <button type="button" onclick="exitChat()">
  <i class="fa-solid fa-xmark"></i> End Chat
</button>
  </div>

</div>
<script src="index.js" defer></script>
</body>
</html>
