<!DOCTYPE html>
<html>
<head>
  <title>Payment Success</title>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>

<h3>Payment successful. Adding credits…</h3>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyALzPqt1EdWG9cWeFf2gZ470D0puPds",
  authDomain: "astrolab-b8956.firebaseapp.com",
  databaseURL: "https://astrolab-b8956-default-rtdb.firebaseio.com",
  projectId: "astrolab-b8956",
  storageBucket: "astrolab-b8956.appspot.com",
  messagingSenderId: "83087467626",
  appId: "1:83087467626:web:66f6b648562f5939425613"
};

firebase.initializeApp(firebaseConfig);

firebase.auth().onAuthStateChanged(user => {
  if(!user){
    document.body.innerHTML = "Please login again.";
    return;
  }

  const creditsToAdd = 50; // same as your ₹50 pack

  const ref = firebase.database().ref("presence/" + user.uid + "/credits");

  ref.transaction(c => (c || 0) + creditsToAdd)
    .then(() => {
      document.body.innerHTML = "✅ Credits added successfully.<br>You can close this page.";
    });
});
</script>

</body>
</html>
